{"version":3,"names":["Path1DEffectStyle","JsiDeclarationNode","DeclarationType","NodeType","enumKey","processPath","composeDeclarations","PathEffectDeclaration","constructor","ctx","type","props","PathEffect","composeAndPush","pe1","save","decorateChildren","pe2","pathEffects","popAllAsOne","restore","pe","Skia","MakeCompose","push","DiscretePathEffectNode","DiscretePathEffect","decorate","length","deviation","seed","MakeDiscrete","Path2DPathEffectNode","Path2DPathEffect","matrix","path","MakePath2D","Error","DashPathEffectNode","DashPathEffect","intervals","phase","MakeDash","CornerPathEffectNode","CornerPathEffect","r","MakeCorner","SumPathEffectNode","SumPathEffect","pes","popAll","MakeSum","bind","Line2DPathEffectNode","Line2DPathEffect","width","MakeLine2D","Path1DPathEffectNode","Path1DPathEffect","advance","style","MakePath1D"],"sources":["PathEffects.ts"],"sourcesContent":["import { Path1DEffectStyle } from \"../../../skia/types\";\nimport type { SkPathEffect } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  CornerPathEffectProps,\n  DashPathEffectProps,\n  DiscretePathEffectProps,\n  Line2DPathEffectProps,\n  Path1DPathEffectProps,\n  Path2DPathEffectProps,\n} from \"../../types\";\nimport { DeclarationType, NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport { processPath } from \"../datatypes\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\nimport { composeDeclarations } from \"../../types/DeclarationContext\";\n\nabstract class PathEffectDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, DeclarationType.PathEffect, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, pe1: SkPathEffect) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const pe2 = ctx.pathEffects.popAllAsOne();\n    ctx.restore();\n    const pe = pe2 ? this.Skia.PathEffect.MakeCompose(pe1, pe2) : pe1;\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class DiscretePathEffectNode extends PathEffectDeclaration<DiscretePathEffectProps> {\n  constructor(ctx: NodeContext, props: DiscretePathEffectProps) {\n    super(ctx, NodeType.DiscretePathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { length, deviation, seed } = this.props;\n    const pe = this.Skia.PathEffect.MakeDiscrete(length, deviation, seed);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path2DPathEffectNode extends PathEffectDeclaration<Path2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path2DPathEffectProps) {\n    super(ctx, NodeType.Path2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath2D(matrix, path);\n    if (pe === null) {\n      throw new Error(\"Path2DPathEffectNode: invalid path\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class DashPathEffectNode extends PathEffectDeclaration<DashPathEffectProps> {\n  constructor(ctx: NodeContext, props: DashPathEffectProps) {\n    super(ctx, NodeType.DashPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { intervals, phase } = this.props;\n    const pe = this.Skia.PathEffect.MakeDash(intervals, phase);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class CornerPathEffectNode extends PathEffectDeclaration<CornerPathEffectProps> {\n  constructor(ctx: NodeContext, props: CornerPathEffectProps) {\n    super(ctx, NodeType.CornerPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { r } = this.props;\n    const pe = this.Skia.PathEffect.MakeCorner(r);\n    if (pe === null) {\n      throw new Error(\"CornerPathEffectNode: couldn't create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class SumPathEffectNode extends PathEffectDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SumPathEffect, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    this.decorateChildren(ctx);\n    const pes = ctx.pathEffects.popAll();\n    const pe = composeDeclarations(\n      pes,\n      this.Skia.PathEffect.MakeSum.bind(this.Skia.PathEffect)\n    );\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class Line2DPathEffectNode extends PathEffectDeclaration<Line2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Line2DPathEffectProps) {\n    super(ctx, NodeType.Line2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { width, matrix } = this.props;\n    const pe = this.Skia.PathEffect.MakeLine2D(width, matrix);\n    if (pe === null) {\n      throw new Error(\"Line2DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path1DPathEffectNode extends PathEffectDeclaration<Path1DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path1DPathEffectProps) {\n    super(ctx, NodeType.Path1DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { advance, phase, style } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath1D(\n      path,\n      advance,\n      phase,\n      Path1DEffectStyle[enumKey(style)]\n    );\n    if (pe === null) {\n      throw new Error(\"Path1DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n"],"mappings":"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"}