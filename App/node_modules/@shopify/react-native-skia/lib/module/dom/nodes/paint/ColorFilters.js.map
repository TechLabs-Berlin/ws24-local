{"version":3,"names":["BlendMode","JsiDeclarationNode","DeclarationType","NodeType","enumKey","ColorFilterDeclaration","constructor","ctx","type","props","ColorFilter","composeAndPush","cf1","save","decorateChildren","cf2","colorFilters","popAllAsOne","restore","cf","Skia","MakeCompose","push","MatrixColorFilterNode","MatrixColorFilter","decorate","matrix","MakeMatrix","BlendColorFilterNode","BlendColorFilter","mode","color","Color","MakeBlend","LinearToSRGBGammaColorFilterNode","LinearToSRGBGammaColorFilter","MakeLinearToSRGBGamma","SRGBToLinearGammaColorFilterNode","SRGBToLinearGammaColorFilter","MakeSRGBToLinearGamma","LumaColorFilterNode","LumaColorFilter","MakeLumaColorFilter","LerpColorFilterNode","LerpColorFilter","t","second","pop","first","Error","MakeLerp"],"sources":["ColorFilters.ts"],"sourcesContent":["import type { SkColorFilter } from \"../../../skia/types\";\nimport { BlendMode } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  BlendColorFilterProps,\n  MatrixColorFilterProps,\n} from \"../../types\";\nimport { DeclarationType, NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport type { LerpColorFilterProps } from \"../../types/ColorFilters\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\n\nexport abstract class ColorFilterDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, DeclarationType.ColorFilter, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, cf1: SkColorFilter) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const cf2 = ctx.colorFilters.popAllAsOne();\n    ctx.restore();\n    const cf = cf2 ? this.Skia.ColorFilter.MakeCompose(cf1, cf2) : cf1;\n    ctx.colorFilters.push(cf);\n  }\n}\n\nexport class MatrixColorFilterNode extends ColorFilterDeclaration<MatrixColorFilterProps> {\n  constructor(ctx: NodeContext, props: MatrixColorFilterProps) {\n    super(ctx, NodeType.MatrixColorFilter, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const cf = this.Skia.ColorFilter.MakeMatrix(matrix);\n    this.composeAndPush(ctx, cf);\n  }\n}\n\nexport class BlendColorFilterNode extends ColorFilterDeclaration<BlendColorFilterProps> {\n  constructor(ctx: NodeContext, props: BlendColorFilterProps) {\n    super(ctx, NodeType.BlendColorFilter, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { mode } = this.props;\n    const color = this.Skia.Color(this.props.color);\n    const cf = this.Skia.ColorFilter.MakeBlend(color, BlendMode[enumKey(mode)]);\n    this.composeAndPush(ctx, cf);\n  }\n}\n\nexport class LinearToSRGBGammaColorFilterNode extends ColorFilterDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.LinearToSRGBGammaColorFilter, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const cf = this.Skia.ColorFilter.MakeLinearToSRGBGamma();\n    this.composeAndPush(ctx, cf);\n  }\n}\n\nexport class SRGBToLinearGammaColorFilterNode extends ColorFilterDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SRGBToLinearGammaColorFilter, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const cf = this.Skia.ColorFilter.MakeSRGBToLinearGamma();\n    this.composeAndPush(ctx, cf);\n  }\n}\n\nexport class LumaColorFilterNode extends ColorFilterDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.LumaColorFilter, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const cf = this.Skia.ColorFilter.MakeLumaColorFilter();\n    this.composeAndPush(ctx, cf);\n  }\n}\n\nexport class LerpColorFilterNode extends ColorFilterDeclaration<LerpColorFilterProps> {\n  constructor(ctx: NodeContext, props: LerpColorFilterProps) {\n    super(ctx, NodeType.LerpColorFilter, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const { t } = this.props;\n    const second = ctx.colorFilters.pop();\n    const first = ctx.colorFilters.pop();\n    ctx.restore();\n    if (!first || !second) {\n      throw new Error(\n        \"LerpColorFilterNode: missing two color filters as children\"\n      );\n    }\n    ctx.colorFilters.push(this.Skia.ColorFilter.MakeLerp(t, first, second));\n  }\n}\n"],"mappings":"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"}