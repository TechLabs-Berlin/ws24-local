{"version":3,"names":["HostObject","ckEnum","JsiSkPaint","JsiSkPoint","JsiSkRect","JsiSkTypeface","JsiSkFont","constructor","CanvasKit","ref","delete","getTextWidth","text","paint","ids","getGlyphIDs","widths","getGlyphWidths","reduce","a","b","getMetrics","result","ascent","descent","leading","bounds","undefined","str","numCodePoints","glyphs","fromValue","getGlyphIntercepts","positions","top","bottom","map","p","Array","from","flat","getScaleX","getSize","getSkewX","isEmbolden","getTypeface","tf","setEdging","edging","setEmbeddedBitmaps","embeddedBitmaps","setHinting","hinting","setLinearMetrics","linearMetrics","setScaleX","sx","setSize","points","setSkewX","setEmbolden","embolden","setSubpixel","subpixel","setTypeface","face"],"sources":["JsiSkFont.ts"],"sourcesContent":["import type { CanvasKit, Font } from \"canvaskit-wasm\";\n\nimport type {\n  FontEdging,\n  FontHinting,\n  SkFont,\n  SkPaint,\n  SkPoint,\n  SkTypeface,\n} from \"../types\";\n\nimport { HostObject, ckEnum } from \"./Host\";\nimport { JsiSkPaint } from \"./JsiSkPaint\";\nimport { JsiSkPoint } from \"./JsiSkPoint\";\nimport { JsiSkRect } from \"./JsiSkRect\";\nimport { JsiSkTypeface } from \"./JsiSkTypeface\";\n\nexport class JsiSkFont extends HostObject<Font, \"Font\"> implements SkFont {\n  constructor(CanvasKit: CanvasKit, ref: Font) {\n    super(CanvasKit, ref, \"Font\");\n  }\n\n  dispose = () => {\n    this.ref.delete();\n  };\n\n  getTextWidth(text: string, paint?: SkPaint | undefined) {\n    const ids = this.getGlyphIDs(text);\n    const widths = this.getGlyphWidths(ids, paint);\n    return widths.reduce((a, b) => a + b, 0);\n  }\n\n  getMetrics() {\n    const result = this.ref.getMetrics();\n    return {\n      ascent: result.ascent,\n      descent: result.descent,\n      leading: result.leading,\n      bounds: result.bounds\n        ? new JsiSkRect(this.CanvasKit, result.bounds)\n        : undefined,\n    };\n  }\n\n  getGlyphIDs(str: string, numCodePoints?: number) {\n    // TODO: Fix return value in the C++ implementation\n    return [...this.ref.getGlyphIDs(str, numCodePoints)];\n  }\n\n  // TODO: Fix return value in the C++ implementation, it return float32\n  getGlyphWidths(glyphs: number[], paint?: SkPaint | null) {\n    return [\n      ...this.ref.getGlyphWidths(\n        glyphs,\n        paint ? JsiSkPaint.fromValue(paint) : null\n      ),\n    ];\n  }\n\n  getGlyphIntercepts(\n    glyphs: number[],\n    positions: SkPoint[],\n    top: number,\n    bottom: number\n  ) {\n    return [\n      ...this.ref.getGlyphIntercepts(\n        glyphs,\n        positions.map((p) => Array.from(JsiSkPoint.fromValue(p))).flat(),\n        top,\n        bottom\n      ),\n    ];\n  }\n\n  getScaleX() {\n    return this.ref.getScaleX();\n  }\n\n  getSize() {\n    return this.ref.getSize();\n  }\n\n  getSkewX() {\n    return this.ref.getSkewX();\n  }\n\n  isEmbolden() {\n    return this.ref.isEmbolden();\n  }\n\n  getTypeface() {\n    const tf = this.ref.getTypeface();\n    return tf ? new JsiSkTypeface(this.CanvasKit, tf) : null;\n  }\n\n  setEdging(edging: FontEdging) {\n    this.ref.setEdging(ckEnum(edging));\n  }\n\n  setEmbeddedBitmaps(embeddedBitmaps: boolean) {\n    this.ref.setEmbeddedBitmaps(embeddedBitmaps);\n  }\n\n  setHinting(hinting: FontHinting) {\n    this.ref.setHinting(ckEnum(hinting));\n  }\n\n  setLinearMetrics(linearMetrics: boolean) {\n    this.ref.setLinearMetrics(linearMetrics);\n  }\n\n  setScaleX(sx: number) {\n    this.ref.setScaleX(sx);\n  }\n\n  setSize(points: number) {\n    this.ref.setSize(points);\n  }\n\n  setSkewX(sx: number) {\n    this.ref.setSkewX(sx);\n  }\n\n  setEmbolden(embolden: boolean) {\n    this.ref.setEmbolden(embolden);\n  }\n\n  setSubpixel(subpixel: boolean) {\n    this.ref.setSubpixel(subpixel);\n  }\n\n  setTypeface(face: SkTypeface | null) {\n    this.ref.setTypeface(face ? JsiSkTypeface.fromValue(face) : null);\n  }\n}\n"],"mappings":"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"}