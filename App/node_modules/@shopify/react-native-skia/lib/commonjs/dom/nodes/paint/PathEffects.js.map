{"version":3,"names":["PathEffectDeclaration","JsiDeclarationNode","constructor","ctx","type","props","DeclarationType","PathEffect","composeAndPush","pe1","save","decorateChildren","pe2","pathEffects","popAllAsOne","restore","pe","Skia","MakeCompose","push","DiscretePathEffectNode","NodeType","DiscretePathEffect","decorate","length","deviation","seed","MakeDiscrete","Path2DPathEffectNode","Path2DPathEffect","matrix","path","processPath","MakePath2D","Error","DashPathEffectNode","DashPathEffect","intervals","phase","MakeDash","CornerPathEffectNode","CornerPathEffect","r","MakeCorner","SumPathEffectNode","SumPathEffect","pes","popAll","composeDeclarations","MakeSum","bind","Line2DPathEffectNode","Line2DPathEffect","width","MakeLine2D","Path1DPathEffectNode","Path1DPathEffect","advance","style","MakePath1D","Path1DEffectStyle","enumKey"],"sources":["PathEffects.ts"],"sourcesContent":["import { Path1DEffectStyle } from \"../../../skia/types\";\nimport type { SkPathEffect } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  CornerPathEffectProps,\n  DashPathEffectProps,\n  DiscretePathEffectProps,\n  Line2DPathEffectProps,\n  Path1DPathEffectProps,\n  Path2DPathEffectProps,\n} from \"../../types\";\nimport { DeclarationType, NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport { processPath } from \"../datatypes\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\nimport { composeDeclarations } from \"../../types/DeclarationContext\";\n\nabstract class PathEffectDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, DeclarationType.PathEffect, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, pe1: SkPathEffect) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const pe2 = ctx.pathEffects.popAllAsOne();\n    ctx.restore();\n    const pe = pe2 ? this.Skia.PathEffect.MakeCompose(pe1, pe2) : pe1;\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class DiscretePathEffectNode extends PathEffectDeclaration<DiscretePathEffectProps> {\n  constructor(ctx: NodeContext, props: DiscretePathEffectProps) {\n    super(ctx, NodeType.DiscretePathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { length, deviation, seed } = this.props;\n    const pe = this.Skia.PathEffect.MakeDiscrete(length, deviation, seed);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path2DPathEffectNode extends PathEffectDeclaration<Path2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path2DPathEffectProps) {\n    super(ctx, NodeType.Path2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath2D(matrix, path);\n    if (pe === null) {\n      throw new Error(\"Path2DPathEffectNode: invalid path\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class DashPathEffectNode extends PathEffectDeclaration<DashPathEffectProps> {\n  constructor(ctx: NodeContext, props: DashPathEffectProps) {\n    super(ctx, NodeType.DashPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { intervals, phase } = this.props;\n    const pe = this.Skia.PathEffect.MakeDash(intervals, phase);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class CornerPathEffectNode extends PathEffectDeclaration<CornerPathEffectProps> {\n  constructor(ctx: NodeContext, props: CornerPathEffectProps) {\n    super(ctx, NodeType.CornerPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { r } = this.props;\n    const pe = this.Skia.PathEffect.MakeCorner(r);\n    if (pe === null) {\n      throw new Error(\"CornerPathEffectNode: couldn't create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class SumPathEffectNode extends PathEffectDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SumPathEffect, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    this.decorateChildren(ctx);\n    const pes = ctx.pathEffects.popAll();\n    const pe = composeDeclarations(\n      pes,\n      this.Skia.PathEffect.MakeSum.bind(this.Skia.PathEffect)\n    );\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class Line2DPathEffectNode extends PathEffectDeclaration<Line2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Line2DPathEffectProps) {\n    super(ctx, NodeType.Line2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { width, matrix } = this.props;\n    const pe = this.Skia.PathEffect.MakeLine2D(width, matrix);\n    if (pe === null) {\n      throw new Error(\"Line2DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path1DPathEffectNode extends PathEffectDeclaration<Path1DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path1DPathEffectProps) {\n    super(ctx, NodeType.Path1DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { advance, phase, style } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath1D(\n      path,\n      advance,\n      phase,\n      Path1DEffectStyle[enumKey(style)]\n    );\n    if (pe === null) {\n      throw new Error(\"Path1DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n"],"mappings":"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"}