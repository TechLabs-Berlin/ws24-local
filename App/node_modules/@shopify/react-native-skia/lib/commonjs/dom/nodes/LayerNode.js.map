{"version":3,"names":["LayerNode","JsiRenderNode","constructor","ctx","props","NodeType","Layer","renderNode","hasLayer","layer","children","JsiDeclarationNode","declCtx","declarationCtx","save","decorate","paint","paints","pop","restore","canvas","saveLayer","map","child","render"],"sources":["LayerNode.ts"],"sourcesContent":["import type { DrawingContext } from \"../types\";\nimport { NodeType } from \"../types\";\nimport type { ChildrenProps } from \"../types/Common\";\n\nimport { JsiRenderNode } from \"./RenderNode\";\nimport type { NodeContext } from \"./Node\";\nimport { JsiDeclarationNode } from \"./Node\";\n\nexport class LayerNode extends JsiRenderNode<ChildrenProps> {\n  constructor(ctx: NodeContext, props: ChildrenProps) {\n    super(ctx, NodeType.Layer, props);\n  }\n\n  renderNode(ctx: DrawingContext): void {\n    let hasLayer = false;\n    const [layer, ...children] = this.children();\n    if (layer instanceof JsiDeclarationNode) {\n      const declCtx = ctx.declarationCtx;\n      declCtx.save();\n      layer.decorate(declCtx);\n      const paint = declCtx.paints.pop();\n      declCtx.restore();\n      if (paint) {\n        hasLayer = true;\n        ctx.canvas.saveLayer(paint);\n      }\n    }\n    children.map((child) => {\n      if (child instanceof JsiRenderNode) {\n        child.render(ctx);\n      }\n    });\n    if (hasLayer) {\n      ctx.canvas.restore();\n    }\n  }\n}\n"],"mappings":";;;;;;;AACA;;AAGA;;AAEA;;AAEO,MAAMA,SAAN,SAAwBC,yBAAxB,CAAqD;EAC1DC,WAAW,CAACC,GAAD,EAAmBC,KAAnB,EAAyC;IAClD,MAAMD,GAAN,EAAWE,eAAA,CAASC,KAApB,EAA2BF,KAA3B;EACD;;EAEDG,UAAU,CAACJ,GAAD,EAA4B;IACpC,IAAIK,QAAQ,GAAG,KAAf;IACA,MAAM,CAACC,KAAD,EAAQ,GAAGC,QAAX,IAAuB,KAAKA,QAAL,EAA7B;;IACA,IAAID,KAAK,YAAYE,wBAArB,EAAyC;MACvC,MAAMC,OAAO,GAAGT,GAAG,CAACU,cAApB;MACAD,OAAO,CAACE,IAAR;MACAL,KAAK,CAACM,QAAN,CAAeH,OAAf;MACA,MAAMI,KAAK,GAAGJ,OAAO,CAACK,MAAR,CAAeC,GAAf,EAAd;MACAN,OAAO,CAACO,OAAR;;MACA,IAAIH,KAAJ,EAAW;QACTR,QAAQ,GAAG,IAAX;QACAL,GAAG,CAACiB,MAAJ,CAAWC,SAAX,CAAqBL,KAArB;MACD;IACF;;IACDN,QAAQ,CAACY,GAAT,CAAcC,KAAD,IAAW;MACtB,IAAIA,KAAK,YAAYtB,yBAArB,EAAoC;QAClCsB,KAAK,CAACC,MAAN,CAAarB,GAAb;MACD;IACF,CAJD;;IAKA,IAAIK,QAAJ,EAAc;MACZL,GAAG,CAACiB,MAAJ,CAAWD,OAAX;IACD;EACF;;AA3ByD"}